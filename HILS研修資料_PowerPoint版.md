# HILS入門研修資料 - PowerPoint版
## 電動パワーステアリング(EPS)制御開発を例に

---

## 【表紙スライド】
### タイトル: HILS入門
### サブタイトル: 電動パワーステアリング(EPS)制御開発を例に
- 研修時間: 90分（講義60分＋実演20分＋質疑10分）
- 対象者: 新入社員（配属1年目）
- 講師名: 〇〇 〇〇
- 所属: 〇〇部 〇〇課
- 日付: 2025年8月15日

**スピーカーノート:**
皆さん、こんにちは。ただ今ご紹介にあずかりました、〇〇部の〇〇です。
本日はお忙しい中、HILS入門の研修にご参加いただき、ありがとうございます。
これから約1時間、皆さんの今後の開発業務に必ず役立つ「HILS」という技術について、私の専門である電動パワーステアリングを例にご紹介します。

---

## 【スライド1: はじめに】（4分）

### 私が新人だった頃の悩み
• 実車じゃないとわからない不具合が多い
• 試作車の予約が取れない、先輩に気を使う
• 危険なテストはできない
• 特定環境（氷点下等）のテストは出張が必要

### HILSがこれらの悩みを解決！

### 本日のアジェンダ
1. HILSとは？
2. なぜHILSを使うのか？（メリット）
3. 【具体例】EPS開発におけるHILS活用法
4. HILSの限界と今後の展望
5. まとめ

---

## 【スライド2: 用語と前提】（5分）

### 基本用語の定義
• **ECU**: 車載電子制御装置（EPSの頭脳部分）
• **CAN**: 車載通信規格（最大1Mbps）
• **PWM**: モーター駆動制御方式（通常20kHz程度）
• **プラントモデル**: 実機の振る舞いを数式化したモデル
• **リアルタイム性**: 一定周期（EPS: 100μs〜500μs）で計算完了
• **フェールセーフ**: 故障時に安全側へ制御を移す設計思想
• **ロードシミュレータ**: 路面反力を物理的に再現する装置
• **DIL**: Driver-in-the-Loop（実際のドライバーが操作）

### 開発フローの位置づけ
```
MIL → SIL → PIL → HILS → 実車評価
↑                    ↑
モデルのみ           実ECUハード（本日のテーマ）
```

---

## 【スライド3: HILSとは？】（7分）

### HILS = Hardware-in-the-Loop Simulation

### 概念図（閉ループ構成）
```
[対象ECU(実機)] ←→ [I/Oインターフェース] ←→ [リアルタイムシミュレータ]
                                                    ├─ トルクセンサーモデル
                                                    ├─ EPSモータモデル
                                                    └─ 車両ダイナミクスモデル
```

### ECUは「実車に乗っている」と錯覚する
• I/O経由の信号を「本物のセンサー情報」と認識
• 計算結果を「本物のモーター」に出力するつもりで動作
• この閉ループ内でECUの挙動を評価

**図表作成メモ:**
- PowerPointのSmartArtで「サイクル」型の図形を使用
- 各要素を色分け（ECU:青、I/O:グレー、センサー:水色、モータ:赤、車両:緑）

---

## 【スライド4: なぜHILSを使うのか？】（7分）

### 開発のフロントローディングを実現する5つのメリット

#### 1. 安全性 (Safety)
• 危険な故障モード（モーター暴走、センサー断線）を安全に再現
• フェールセーフ機能の作り込みに絶大な効果

#### 2. 開発効率向上 (Efficiency)
• 試作車完成前からECUの論理検証が可能
• 手戻りを大幅に削減

#### 3. コスト削減 (Cost)
• 試作車・テストコースの使用時間削減
• 開発期間短縮によるコスト減

#### 4. 再現性と網羅性 (Reproducibility & Coverage)
• 100%同じ条件で再現可能
• 数千〜数万パターンの自動テスト

#### 5. 場所・時間の制約からの解放 (Flexibility)
• 真冬の凍結路も真夏の渋滞もデスク上で再現
• 夜間の自動テスト実行

---

## 【スライド5: EPS開発におけるHILS活用法 - 構成】（5分）

### EPSの実機構成（閉ループ）
```
[ECU] → [EPSモータ] → [トルクセンサー] → [ECU]
   ↑                                        ↓
   └────── トルク/角度信号 ←────────┘
```

### EPS向けHILS詳細構成
```
実ECU ←→ I/Oインターフェース ←→ シミュレータ群
                                    ├─ トルクセンサーモデル
                                    ├─ ステアリング機構モデル
                                    ├─ 車両モデル
                                    └─ EPSモータモデル
```

**図表作成メモ:**
- PowerPointの図形ツールで作成
- 矢印で信号の流れを明示
- 実機は紫色、モデルは各色で区別

---

## 【スライド6: HILSの構成バリエーション】（3分）

### 目的に応じて実機/シミュレータを使い分け

#### パターン1: ECUのみ実機
• 早期の機能検証・大量自動テストに最適

#### パターン2: ECU＋センサー＋モータ＋ロードシミュレータ（実機）
• センサ/アクチュエータ連携評価
• 故障・安全評価
• 実機制約（飽和/熱）の確認

#### パターン3: DIL（ステアリングホイール実機装着）
• 操舵フィーリングの素早い検討
• ※最終判断は実車で

---

## 【スライド7: テストシナリオ】（5分）

### HILSでこんなテストができます

#### 基本性能評価
• **据え切り評価**: 車速ゼロでのアシスト特性
• **車速感応評価**: 低速は軽く、高速はしっかり
• **ハンドル戻り性評価**: コーナリング後の直進復帰

#### 故障シミュレーション（フェールセーフ検証）
• **トルクセンサー断線**: 異常検知→アシスト停止→警告灯点灯
• **車速信号途絶**: 車速不明時の制御モード遷移
• **モータードライバ故障**: システムの安全停止
• **電源電圧異常**: エンジン再始動時の誤作動防止

#### DILベンチでの体感評価
• 操舵フィーリング（センター戻り、初期応答）
• 反力マップ切替による特性比較

### ⚡実車では困難な「限界領域」のテストがHILSの真骨頂！

---

## 【スライド8: 自動テスト】（3分）

### 回帰テスト（リグレッションテスト）の自動化

#### 開発の流れ
1. ソフトウェアの一部を修正
2. 夜間に数千件のテストケースを自動実行
3. 朝出社時には合否判定レポートが完成

#### メリット
• デグレード（他機能への悪影響）を防止
• 安心して機能追加・仕様変更が可能
• 開発スピードと品質の両立

---

## 【スライド9: HILSの限界と今後の展望】（7分）

### HILSの限界
• **モデル精度依存**: モデル化されていない現象は再現不可
  - 例: モーターの微小振動、ECUの熱による特性変化
• **最終的な官能評価**: 実車評価が必要
• **HILSは万能ではない**: 実車評価を補完するツール

### 新人がハマりやすい落とし穴
• 単位不一致（Nm vs Ncm、deg vs rad）
• リアルタイム負荷超過
• テストケースの合否基準未定義
• モデル精度の過信（許容誤差: 位相±5%、ゲイン±10%）

### HILSベンダー例と価格帯
• **dSPACE**: 最大手、高機能（数千万円〜）
• **ETAS**: ドイツ系メーカーに強い
• **National Instruments**: 柔軟性高、コスパ良好
• **IPG Automotive**: 車両シミュレーション特化

### 今後の展望（XiL: X-in-the-Loop）
• MBD（モデルベース開発）の中核技術
• SIL/VIL等との連携
• クラウド上での大規模並列シミュレーション

---

## 【スライド10: まとめ】（3分）

### 本日のポイント

#### HILSとは
ECUに「仮想的な車両」を接続するテスト手法

#### 5つのメリット
1. **安全**に危険な状態をテスト
2. 開発の**フロントローディング**
3. テストの**自動化**で網羅性向上
4. **コスト削減**
5. **時間・場所**の制約から解放

#### EPS開発での活用
基本性能から故障時まで幅広い検証に活用

### 💡HILSを使いこなすことが、複雑化する車載ソフトウェア開発を成功させる鍵

---

## 【スライド11: 実演デモンストレーション】（20分）

### デモ内容

#### 1. HILSベンチの実物紹介（5分）
• 実際のECU、I/Oボックス、リアルタイムPC
• 配線、信号の流れを実物で確認

#### 2. 基本動作デモ（7分）
• ハンドル操作によるEPSアシスト動作
• 車速変化によるアシスト量の変化をリアルタイム表示

#### 3. 故障注入デモ（8分）
• トルクセンサー断線をボタン一つで再現
• ECUのフェールセーフモード移行を確認
• 警告灯点灯、アシスト停止を実演

---

## 【スライド12: 質疑応答】（10分）

### 想定Q&A

**Q1: HILSベンチはいくらくらい？**
A: エントリーモデル1,000万円〜、ハイエンド2億円程度

**Q2: モデル作成の工数は？**
A: 既存流用1-2人月、新規シンプル3-6人月、高精度6-12人月

**Q3: HILS/SIL/MILの使い分けは？**
A: MIL→SIL→PIL→HILS→実車の順で段階的に検証

**Q4: EPS以外のECUにも使える？**
A: エンジン、ブレーキ、ADAS、ボディ系ECU等にも適用可能

**Q5: モデル精度はどの程度必要？**
A: 位相遅れ±5%、ゲイン誤差±10%程度が一般的

---

## 【付録A: コスト・工数の目安】

### HILSベンチ導入コスト
• エントリーモデル: 1,000万円〜3,000万円
• ミッドレンジ: 3,000万円〜8,000万円
• ハイエンド: 8,000万円〜2億円

### モデル作成工数
• 既存モデル流用: 1〜2人月
• 新規シンプルモデル: 3〜6人月
• 高精度モデル: 6〜12人月

---

## 【付録B: 新人のためのチェックリスト】

### 技術理解
□ 社内のHILS環境の場所・予約方法・連絡先を確認
□ 既存テストケースの一覧と合否基準を確認
□ 単位・スケール（deg/rad、Nm/Ncm、V/%）を仕様書で確認
□ 回帰テストの夜間実行ジョブへの登録
□ ログ採取手順（トレース、CANログ、ECUログ）の整備

### 実務適用
□ MIL→SIL→PIL→HILS→実車の流れを理解
□ 自分の担当ECU用のHILS環境を確認
□ モデル精度要求（位相遅れ、ゲイン誤差）を確認

---

## 【付録C: 他ECUへの応用例】

### 各種ECUでのHILS活用
• **エンジンECU**: エンジンモデルと組み合わせて燃費・排ガス評価
• **ブレーキECU (ABS/ESC)**: 滑りやすい路面での制御検証
• **ADAS ECU**: カメラ・レーダー信号を模擬して衝突回避機能を検証
• **ボディECU**: ドアロック、ウインドウ制御の検証

---

## PowerPoint作成時の注意点

### 図表の作成方法
1. **Mermaid図の変換**
   - Mermaid Live Editor (https://mermaid.live/) で画像化
   - PowerPointのSmartArtで再作成
   - draw.io等で作図してインポート

2. **色の統一**
   - ECU: 青 (#2d5be3)
   - I/O: グレー (#9aa0a6)
   - センサー: 水色 (#1fb6d5)
   - モータ: 赤 (#e5534b)
   - 車両: 緑 (#2ea44f)
   - 実機: 紫 (#6f42c1)

3. **アニメーション推奨箇所**
   - スライド3: 閉ループの信号の流れ
   - スライド4: 5つのメリットを順次表示
   - スライド7: 故障注入のプロセス

### フォント・レイアウト
- タイトル: 32pt以上
- 本文: 20pt以上
- 1スライド最大7行まで
- 図表は大きく配置

### 配布資料
- スピーカーノートを含めて印刷
- 実演デモの部分は写真を追加
- チェックリストは別紙配布